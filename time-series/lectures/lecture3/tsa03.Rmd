---
title: 時系列分析 第3回
subtitle: ARMA過程1
author: Kenichiro Tamaki
date: 2022年4月25日
# date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    number_sections: yes
css: style.css
# csl: apa.csl
# bibliography: references.bib
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<p><br></p>

# 2 ARMA過程 {-}

## 2.1 ARMA過程の性質 {-}

$y_{t}$ と $y_{t - 1}$ に相関があるモデルを考える.

- $y_{t}$ と $y_{t - 1}$ のモデルに共通の成分がある (MAモデル)
$$
\begin{cases}
y_{t} = a + b \\
y_{t - 1} = b + c
\end{cases}
$$

- $y_{t}$ のモデルに $y_{t - 1}$ が含まれている (ARモデル)
$$
y_{t} = a y_{t - 1} + b
$$

### 2.1.1 MA過程 {-}

**移動平均 (MA: moving average) 過程**

1次のMA過程は次である.
$$
y_{t} = \mu + \varepsilon_{t} + \theta \varepsilon_{t - 1}, \quad \varepsilon_{t} \sim \text{WN} (\sigma^{2})
$$

- ホワイト・ノイズの線形和である

- <span style="color: rgb(255, 0, 0);">$y_{t} \sim \text{MA}(1)$</span> と表記する

- $y_{t}$ と $y_{t - 1}$ のモデルに共通項 $\varepsilon_{t - 1}$ があるので, $y_{t}$ と $y_{t - 1}$ に相関がある
$$
\begin{cases}
y_{t} = \mu + \varepsilon_{t} + \theta \varepsilon_{t - 1} \\
y_{t - 1} = \mu + \varepsilon_{t - 1} + \theta \varepsilon_{t - 2}
\end{cases}
$$

**MA(1) の性質**

- 平均
$$
E [y_{t}] = E [\mu + \varepsilon_{t} + \theta \varepsilon_{t - 1}] = \mu
$$

- 分散
$$
\gamma_{0} = V (y_{t}) = V (\mu + \varepsilon_{t} + \theta \varepsilon_{t - 1}) = (1 + \theta^{2}) \sigma^{2}
$$

- 1次の自己共分散
$$
\gamma_{1} = \text{Cov} (y_{t}, y_{t - 1}) = \theta \sigma^{2}
$$

- 1次の自己相関係数
$$
\rho_{1} = \frac{\gamma_{1}}{\gamma_{0}} = \frac{\theta}{1 + \theta^{2}}
$$
$\theta = 1$ のとき最大値 $\frac{1}{2}$, $\theta = -1$ のとき最小値 $-\frac{1}{2}$

- $k$ 次 $(k \ge 2)$ の自己共分散
$$
\gamma_{k} = \text{Cov} (y_{t}, y_{t - k}) = 0
$$

- <span style="color: rgb(255, 0, 0);">$k$ 次 $(k \ge 2)$ の自己相関係数
$$
\rho_{k} = 0
$$
</span>

- MA(1) は1次の自己相関をモデル化できるが, 2次以上の自己相関は記述できない
$$
\begin{cases}
y_{t} = \mu + \varepsilon_{t} + \theta\varepsilon_{t - 1} \\
y_{t - 1} = \mu + \varepsilon_{t - 1} + \theta\varepsilon_{t - 2} \\
y_{t - 2} = \mu + \varepsilon_{t - 2} + \theta\varepsilon_{t - 3}
\end{cases}
$$
$y_{t}$ と $y_{t - 2}$ に共通項がないので相関はない

**MA(1) の模擬データ**

図2.1 (p.22) と同じ MA(1) の模擬データを生成し, 独立な模擬データと比較する. 標本数は $200$ とする. 

関数 arima.sim を用いると時系列モデルの模擬データを作成できる. 詳細はヘルプファイルを見て下さい.

```{r eval = FALSE}
?arima.sim # 関数 arima.sim のヘルプファイル
```

MA(1) の模擬データを生成する.

```{r}
T <- 200 # 標本数
ma1 <- c(0, 0, 1) # MA(1)

# 図2.1 (a)
ma.c = 0.8 # MA係数 0.8
ma1a <- arima.sim(list(order = ma1, ma = ma.c), n = T)

# 図2.1 (b)
mu = 2; ma.c = 0.5; sd = 0.5 # 平均 2, MA係数 0.5, 標準偏差 0.5
ma1b <- mu + arima.sim(list(order = ma1, ma = ma.c), sd = sd, n = T)

# 図2.1 (c)
mu = -2; ma.c = 0.3; sd = 2 # 平均 -2, MA係数 0.3, 標準偏差 2
ma1c <- mu + arima.sim(list(order = ma1, ma = ma.c), sd = sd, n = T)

# 図2.1 (d)
ma.c = -0.3 # MA係数 -0.3
ma1d <- arima.sim(list(order = ma1, ma = ma.c), n = T)

# 図2.1 (e)
mu = 2; ma.c = -0.5; sd = 0.5 # 平均 2, MA係数 -0.5, 標準偏差 0.5
ma1e <- mu + arima.sim(list(order = ma1, ma = ma.c), sd = sd, n = T)

# 図2.1 (f)
mu = -2; ma.c = -0.8; sd = 2 # 平均 -2, MA係数 -0.8, 標準偏差 2
ma1f <- mu + arima.sim(list(order = ma1, ma = ma.c), sd = sd, n = T)
```

ここでは, 独立なデータと自己相関があるデータの時系列プロットとコレログラムを比較する. まずは時系列プロットを比較する.

```{r fig.height = 6, fig.width = 9}
x1 <- rnorm(T) # 独立に標準正規分布に従う模擬データ
x2 <- rnorm(T, 2, 0.5) # 平均 2, 標準偏差 0.5

par(mfrow = c(2, 2)) # プロット画面を2行2列に分割
# 時系列プロット
ts.plot(x1); ts.plot(x2) # 時系列でないので ts.plot を用いる
plot(ma1a); plot(ma1f) # 時系列なので ts.plot を用いる必要はない
```

上段は独立なデータの時系列プロット, 下段は MA(1) の時系列プロットである. 時系列プロットからは違いが分からない. 次に, コレログラムを比較する.

```{r fig.height = 6, fig.width = 9}
par(mfrow = c(2, 2)) # プロット画面を2行2列に分割
# コレログラム
acf(x1); acf(x2) # 上段
acf(ma1a); acf(ma1f) # 下段
```

上段は独立なデータのコレログラム, 下段は MA(1) のコレログラムである. 独立なデータは全てのラグにおいて相関がないが, MA(1) はラグ $1$ において相関があるので, 明らかに異なる.

**MA($q$)**

$q$ 次のMA過程は次である.
$$
y_{t} = \mu + \varepsilon_{t} + \theta_{1} \varepsilon_{t - 1} + \dots + \theta_{q} \varepsilon_{t - q}, \quad \varepsilon_{t} \sim \text{WN} (\sigma^{2})
$$

> **定理2.1 (MA($q$) の性質, p.24)**  
(1) 平均
$$
E [y_{t}] = \mu
$$
(2) 分散
$$
\gamma_{0} = V (y_{t}) = (1 + \theta_{1}^{2} + \dots + \theta_{q}^{2}) \sigma^{2}
$$
(3) $k$ 次の自己共分散 ($\theta_{0} = 1$ とする)
$$
\gamma_{k} = 
\begin{cases}
(\theta_{k} + \theta_{1} \theta_{k + 1} + \dots + \theta_{q - k} \theta_{q}) \sigma^{2}, & 1 \le k \le q \\
0, & k \ge q + 1
\end{cases}
$$
(4) <span style="color: rgb(255, 0, 0);">MA過程は常に定常である</span>  
(5) $k$ 次の自己相関係数
$$
\rho_{k} =
\begin{cases}
\dfrac{\theta_{k} + \theta_{1} \theta_{k + 1} + \dots + \theta_{q - k} \theta_{q}}{1 + \theta_{1}^{2} + \dots + \theta_{q}^{2}}, & 1 \le k \le q \\
0, & k \ge q + 1
\end{cases}
$$

**MA(2) の模擬データ**

図2.2 (p.25) と同じ MA(2) の模擬データを生成する.

```{r}
T <- 200 # 標本数
ma1 <- c(0, 0, 1) # MA(1)
ma2 <- c(0, 0, 2) # MA(2)

# 図2.2 (a) 
ma.c = 0.8 # MA1係数 0.8
ma2a <- arima.sim(list(order = ma1, ma = ma.c), n = T)

# 図2.2 (b)
ma.c = -0.8 # MA1係数 -0.8
ma2b <- arima.sim(list(order = ma1, ma = ma.c), n = T)

# 図2.2 (c)
ma.c = c(0.8, 0.3) # MA1係数 0.8, MA2係数 0.3
ma2c <- arima.sim(list(order = ma2, ma = ma.c), n = T)

# 図2.2 (d)
ma.c = c(0.3, 0.8) # MA1係数 0.3, MA2係数 0.8
ma2d <- arima.sim(list(order = ma2, ma = ma.c), n = T)

# 図2.2 (e)
ma.c = c(0.8, -0.3) # MA1係数 0.8, MA2係数 -0.3
ma2e <- arima.sim(list(order = ma2, ma = ma.c), n = T)

# 図2.2 (f)
ma.c = c(-0.8, -0.3) # MA1係数 -0.8, MA2係数 -0.3
ma2f <- arima.sim(list(order = ma2, ma = ma.c), n = T)
```

まず, 時系列をプロットする.

```{r fig.height = 8, fig.width = 12}
par(mfrow = c(3, 2)) # プロット画面を3行2列に分割
# 時系列プロット
plot(ma2a); plot(ma2b) # 上段
plot(ma2c); plot(ma2d) # 中段
plot(ma2e); plot(ma2f) # 下段
```

上段は MA(1) の時系列プロット, 中段・下段は MA(2) の時系列プロットである. 次に, コレログラムをプロットする.

```{r fig.height = 8, fig.width = 12}
par(mfrow = c(3, 2)) # プロット画面を3行2列に分割
# コレログラム
acf(ma2a); acf(ma2b) # 上段
acf(ma2c); acf(ma2d) # 中段
acf(ma2e); acf(ma2f) # 下段
```

上段は MA(1) のコレログラム, 中段・下段は MA(2) のコレログラムである. MA(1) はラグ $1$ においてのみ自己相関があるが, MA(2) はラグ $1$ と $2$ において自己相関がある.

**MA過程の問題点**

- $q$ 次の自己相関をモデル化するためには $q$ 個のパラメータが必要

- 長期間にわたる自己相関をモデル化することは困難

- モデルの解釈が難しい (基本的なモデルとして重要)

### 2.1.2 AR過程 {-}

**自己回帰 (AR: autoregressive) 過程**

1次のAR過程は次である.
$$
y_{t} = c + \phi y_{t - 1} + \varepsilon_{t}, \quad \varepsilon_{t} \sim \text{WN} (\sigma^{2})
$$

- 自分の過去を説明変数とする回帰である

- <span style="color: rgb(255, 0, 0);">$y_{t} \sim \text{AR}(1)$</span> と表記する

- $y_{t}$ は $y_{t - 1}$ と $\varepsilon_{t}$ の値によって決まるので, $y_{t}$ と $y_{t - 1}$ に相関がある

- <span style="color: rgb(255, 0, 0);">AR過程は定常とは限らない</span>

**定常 AR(1) の性質**

- 平均
$$
\mu = E [y_{t}] = \frac{c}{1 - \phi}
$$

- 分散
$$
\gamma_{0} = V (y_{t}) = \frac{\sigma^{2}}{1 - \phi^{2}}
$$

- $k$ 次の自己共分散
$$
\gamma_{k} = \text{Cov} (y_{t}, y_{t - k}) = \phi \gamma_{k - 1}
$$

- $k$ 次の自己相関係数
$$
\rho_{k} = \phi \rho_{k - 1} = \dots = \phi^{k} \rho_{0} = \phi^{k}
$$

  - $\lvert \phi \rvert < 1$ のとき, 自己相関係数は指数的に減衰する

  - <span style="color: rgb(255, 0, 0);">AR(1) は, 2次以上の自己相関係数も $0$ でない</span>

**AR(1) の模擬データ**

図2.3 (p.28) と同じ AR(1) の模擬データを生成し, 独立な模擬データと比較する. 標本数は $200$ とする. AR(1) の平均は $c$ ではなく, $\dfrac{c}{1 - \phi}$ である.

```{r}
T <- 200 # 標本数
ar1 <- c(1, 0, 0) # AR(1)

# 図2.3 (a)
const = 2; ar.c = 0.8 # 定数項 2, AR係数 0.8
ar1a <- const / (1 - ar.c) + arima.sim(list(order = ar1, ar = ar.c), n = T)

# 図2.3 (b)
const = -2; ar.c = 0.3; sd = 0.5 # 定数項 -2, AR係数 0.3, 標準偏差 0.5
ar1b <- const / (1 - ar.c) + arima.sim(list(order = ar1, ar = ar.c), sd = sd, n = T)

# 図2.3 (c)
ar.c = -0.3; sd = 2 # AR係数 -0.3, 標準偏差 2
ar1c <- arima.sim(list(order = ar1, ar = ar.c), sd = sd, n = T)

# 図2.3 (d)
const = -2; ar.c = -0.8 # 定数項 -2, AR係数 -0.8
ar1d <- const / (1 - ar.c) + arima.sim(list(order = ar1, ar = ar.c), n = T)

# 図2.3 (e)
ar.c = 1 # AR係数 1
ar1e <- filter(rnorm(T), ar.c, method = "recursive")

# 図2.3 (f)
ar.c = 1.1 # AR係数 1.1
ar1f <- filter(rnorm(T), ar.c, method = "recursive")
```

図2.3 (e), 図2.3 (f) では, AR係数の絶対値が $1$ 以上であり, arima.sim ではエラーとなるので別の方法を用いる. これより, AR過程は定常とは限らないことが分かる.

時系列とコレログラムをプロットする.

```{r fig.height = 8, fig.width = 12}
par(mfrow = c(3, 2)) # プロット画面を3行2列に分割
# 時系列プロット
plot(ar1a); plot(ar1b) # 上段
plot(ar1c); plot(ar1d) # 中段
plot(ar1e); plot(ar1f) # 下段
```

```{r fig.height = 8, fig.width = 12}
par(mfrow = c(3, 2)) # プロット画面を3行2列に分割
# コレログラム
acf(ar1a); acf(ar1b) # 上段
acf(ar1c); acf(ar1d) # 中段
acf(ar1e); acf(ar1f) # 下段
```

コレログラムより, AR(1) 過程は明らかに自己相関がある. 自己相関構造は, ar1a は単調に減衰, ar1d は振動しながら減衰する. ar1b, ar1c はラグ $1$ においてのみ自己相関がある.

**AR($p$) 過程**

$p$ 次のAR過程は次である.
$$
y_{t} = c + \phi_{1} y_{t - 1} + \dots + \phi_{p} y_{t - p} + \varepsilon_{t}, \quad \varepsilon_{t} \sim \text{WN} (\sigma^{2})
$$

> **定理2.2 (定常AR($p$) の性質, p.31)**  
(1) 平均
$$
E [y_{t}] = \frac{c}{1 - \phi_{1} - \dots - \phi_{p}}
$$
(2) 分散
$$
\gamma_{0} = V (y_{t}) = \frac{\sigma^{2}}{1 - \phi_{1} \rho_{1} - \dots - \phi_{p} \rho_{p}}
$$
(3) $k$ 次の自己共分散, $k$ 次の自己相関 $(k \ge 1)$
$$
\begin{align}
& \gamma_{k} = 
\phi_{1} \gamma_{k - 1} + \dots + \phi_{p} \gamma_{k - p} \\
& \rho_{k} = 
\phi_{1} \rho_{k - 1} + \dots + \phi_{p} \rho_{k - p}
\end{align}
$$
これを<span style="color: rgb(255, 0, 0);">ユール・ウォーカー (Yule–Walker) 方程式</span>という  
(4) 自己相関係数は指数的に減衰する

AR過程の自己相関係数は, ユール・ウォーカー方程式を用いて求められる. 初期値は
$$
\begin{align}
& \rho_{1} = 
\phi_{1} + \phi_{2} \rho_{1} + \dots + \phi_{p} \rho_{p - 1} \\
& \rho_{2} = 
\phi_{1} \rho_{1} + \phi_{2} + \dots + \phi_{p} \rho_{p - 2} \\
& \quad \vdots \\
& \rho_{p} = 
\phi_{1} \rho_{p - 1} + \phi_{2} \rho_{p - 2} + \dots + \phi_{p}
\end{align}
$$
より
$$
\begin{align}
\begin{pmatrix}
1 & \rho_{1} & \dots & \rho_{p - 1} \\
\rho_{1} & 1 & \dots & \rho_{p - 2} \\
\vdots & \vdots & \ddots & \vdots \\
\rho_{p - 1} & \rho_{p - 2} & \dots & 1
\end{pmatrix}
\begin{pmatrix}
\phi_{1} \\
\vdots \\
\phi_{p}
\end{pmatrix}
=
\begin{pmatrix}
\rho_{1} \\
\vdots \\
\rho_{p}
\end{pmatrix}
\end{align}
$$
を解くことにより求められるが, 非常に複雑な式となる.

**AR(2) 過程の模擬データ**

図2.4 (p.32) と同じ AR(2) の模擬データを生成する.

```{r}
T <- 200 # 標本数
ar1 <- c(1, 0, 0) # AR(1)
ar2 <- c(2, 0, 0) # AR(2)

# 図2.4 (a)
ar.ca = 0.8 # AR1係数 0.8
ar2a <- arima.sim(list(order = ar1, ar = ar.ca), n = T)

# 図2.4 (b)
ar.cb = -0.8 # AR1係数 -0.8
ar2b <- arima.sim(list(order = ar1, ar = ar.cb), n = T)

# 図2.4 (c)
ar.cc = c(0.5, 0.35) # AR1係数 = 0.5, AR2係数 = 0.35
ar2c <- arima.sim(list(order = ar2, ar = ar.cc), n = T)

# 図2.4 (d)
ar.cd = c(0.1, 0.5) # AR1係数 = 0.1, AR2係数 = 0.5
ar2d <- arima.sim(list(order = ar2, ar = ar.cd), n = T)

# 図2.4 (e)
ar.ce = c(0.5, -0.8) # AR1係数 = 0.5, AR2係数 = -0.8
ar2e <- arima.sim(list(order = ar2, ar = ar.ce), n = T)

# 図2.4 (f)
ar.cf = c(0.9, -0.8) # AR1係数 = 0.9, AR2係数 = -0.8
ar2f <- arima.sim(list(order = ar2, ar = ar.cf), n = T)
```

まず, 時系列をプロットする.

```{r fig.height = 8, fig.width = 12}
par(mfrow = c(3, 2)) # プロット画面を3行2列に分割
# 時系列プロット
plot(ar2a); plot(ar2b) # 上段
plot(ar2c); plot(ar2d) # 中段
plot(ar2e); plot(ar2f) # 下段
```

上段は AR(1) の時系列プロット, 中段・下段は AR(2) の時系列プロットである. 次に, コレログラムをプロットする.

```{r fig.height = 8, fig.width = 12}
par(mfrow = c(3, 2)) # プロット画面を3行2列に分割
# コレログラム
acf(ar2a); acf(ar2b) # 上段
acf(ar2c); acf(ar2d) # 中段
acf(ar2e); acf(ar2f) # 下段
```

上段は AR(1) のコレログラム, 中段・下段は AR(2) のコレログラムである. ar2a, ar2c は単調に減衰, ar2b は振動しながら減衰, ar2e, ar2f は循環しながら減衰することが分かる.

**特性方程式**

- AR($p$)
$$
y_{t} - \phi_{1} y_{t - 1} - \dots - \phi_{p} y_{t - p} = c + \varepsilon_{t}
$$
に対して, 次を<span style="color: rgb(255, 0, 0);">特性方程式</span>という
$$
\Phi(z) = 1 − \phi_{1} z − \phi_{2} z^{2} − \dots - \phi_{p} z^{p} = 0
$$
- $\Phi(z) = 0$ が共役な複素数を解にもつとき, AR($p$) の自己相関係数は循環する

関数 polyroot を用いると, 方程式 $a + b x + c x^{2} = 0$ の解を求めることが出来る.

```{r eval = FALSE}
polyroot(c(a, b, c))
```

```{r}
# (c) 解は実数
polyroot(c(1, -ar.cc))
```

```{r}
# (d) 解は実数
polyroot(c(1, -ar.cd))
```

```{r}
# (e) 解は虚数であるから, 自己相関係数は循環する
polyroot(c(1, -ar.ce))
```

```{r}
# (f) 解は虚数であるから, 自己相関係数は循環する
polyroot(c(1, -ar.cf))
```

### 2.1.3 ARMA過程 {-}

**自己回帰移動平均 (ARMA) 過程**

ARMA($p,q$) は次である.
$$
y_{t} = c + \phi_{1} y_{t - 1} + \dots + \phi_{p} y_{t - p} + \varepsilon_{t} + \theta_{1} \varepsilon_{t - 1} \dots + \theta_{q} \varepsilon_{t - q}, \quad \varepsilon_{t} \sim \text{WN} (\sigma^{2})
$$

> **定理2.3 (定常ARMA($p,q$) の性質, p.34)**    
(1) 平均
$$
E [y_{t}] = \frac{c}{1 - \phi_{1} - \dots - \phi_{p}}
$$
(2) $k$ 次の自己共分散, $k$ 次の自己相関係数 $(k \ge q + 1)$
$$
\begin{align}
& \gamma_{k} = 
\phi_{1} \gamma_{k - 1} + \dots + \phi_{p} \gamma_{k - p} \\
& \rho_{k} = 
\phi_{1} \rho_{k - 1} + \dots + \phi_{p} \rho_{k - p}
\end{align}
$$
(3) 自己相関係数は指数的に減衰する

分散, 自己共分散, 自己相関係数を一般的に表現することは困難である.

## 2.2 ARMA過程の定常性と反転可能性 {-}

- 定常性

  - MA過程は常に定常である

  - AR過程は定常とは限らない

- 識別可能性 (同じ期待値と自己相関構造をもつ過程は複数存在しない)

  - MA過程は識別可能とは限らない

  - 定常AR過程は常に識別可能である

### 2.2.1 AR過程の定常性 {-}

- <span style="color: rgb(255, 0, 0);">特性方程式の全ての解の絶対値が $1$ より大きい ⇒ AR過程は定常</span>

**AR(1) の定常条件**

次の AR(1) を考える.
$$
y_{t} = c + \phi_{1} y_{t - 1} + \varepsilon_{t}
$$

特性方程式 $\Phi(z) = 1 - \phi_{1} z = 0$ の解は $z = \dfrac{1}{\phi_{1}}$ であるから, 定常条件は次である.
<span style="color: rgb(255, 0, 0);">
$$
\left\lvert \frac{1}{\phi_{1}} \right\rvert > 1 \Leftrightarrow \lvert \phi_{1} \rvert < 1
$$
</span>

**AR過程の MA($\infty$) 表現**

次の AR(1) を考える.
$$
y_{t} = \phi_{1} y_{t - 1} + \varepsilon_{t}
$$
ここでは, 簡単のため $c = 0$ とする. $y_{t - 1} = \phi_{1} y_{t - 2} + \varepsilon_{t - 1}$ を代入すると
$$
\begin{align*}
y_{t} &= \phi_{1} y_{t - 1} + \varepsilon_{t} \\
&= \phi_{1} \left( \phi_{1} y_{t - 2} + \varepsilon_{t - 1} \right) + \varepsilon_{t} \\
&= \phi_{1}^{2} y_{t - 2} + \varepsilon_{t} + \phi_{1} \varepsilon_{t - 1}
\end{align*}
$$
であるから, これを繰り返すと
$$
\begin{align*}
y_{t} &= \phi_{1}^{2} \left( \phi_{1} y_{t - 3} + \varepsilon_{t - 2} \right) + \varepsilon_{t} + \phi_{1} \varepsilon_{t - 1} \\
& \quad \vdots \\
&= \phi_{1}^{m} y_{t - m} + \sum_{k = 0}^{m - 1} \phi_{1}^{k} \varepsilon_{t - k}
\end{align*}
$$
である. よって, $\lvert \phi_{1} \rvert < 1$ ならば, $m \to \infty$ のとき次が成り立つ.
$$
y_{t} = \sum_{k = 0}^{\infty} \phi_{1}^{k} \varepsilon_{t - k}
$$
これは確率変数列なので通常の数列の収束とは異なる (平均2乗収束). 

- $\lvert \phi_{1} \rvert < 1$ ⇒ AR(1) は MA($\infty$) で表現可能

- $\lvert \phi_{1} \rvert \ge 1$ ⇒ AR(1) は MA($\infty$) で表現不可能

MA過程は定常であるから, MA($\infty$) で表現可能なAR過程は定常である.

### 2.2.2 MA過程の反転可能性 {-}

**MA過程の識別可能性**

- 次の2つの異なるMA過程は, 同じ期待値と自己相関構造をもつ

  - $y_{t} = \varepsilon_{t} + \theta \varepsilon_{t - 1}$, $\varepsilon_{t} \sim \text{WN} (\sigma^{2})$

  - $y_{t} = \eta_{t} + \frac{1}{\theta} \eta_{t - 1}$, $\eta_{t} \sim \text{WN} (\theta^{2} \sigma^{2})$

- <span style="color: rgb(255, 0, 0);">MA過程は識別可能とは限らない</span>

- 定常AR過程は常に識別可能である

> **定義2.1 (MA過程の反転可能性, p.38)**
MA過程が AR($\infty$) で表現可能であるとき, MA過程は<span style="color: rgb(255, 0, 0);">反転可能 (invertible)</span> という

- 反転可能なMA過程 ⇒ 定常 AR($\infty$) で表現可能 ⇒ 識別可能

次の MA(1) を考える.
$$
y_{t} = \varepsilon_{t} + \theta \varepsilon_{t - 1}
$$ 
ここでは, 簡単のため $\mu = 0$ とする. $\varepsilon_{t} = - \theta \varepsilon_{t - 1} + y_{t}$ より, 前節と同様に
$$
\begin{align*}
\varepsilon_{t} &= -\theta \left( -\theta \varepsilon_{t - 2} + y_{t - 1} \right) + y_{t} \\
& \quad \vdots \\
&= (-\theta)^{m} \varepsilon_{t - m} + \sum_{k = 0}^{m - 1} (-\theta)^{k} y_{t - k}
\end{align*}
$$
である. よって, $\lvert \theta \rvert < 1$ ならば, $m \to \infty$ のとき次が成り立つ.
$$
\varepsilon_{t} = \sum_{k = 0}^{\infty} (-\theta)^{k} y_{t - k}
$$
このとき, MA(1) は 定常 AR($\infty$) で表現可能である. 定常AR過程は反転可能であるから, 定常 AR($\infty$) で表現可能なMA過程は反転可能である.

- MA$(q)$
$$
y_{t} - \mu = \varepsilon_{t} + \theta_{1} \varepsilon_{t - 1} + \dots + \theta_{q} \varepsilon_{t - q}
$$
に対して, 次を特性方程式という
$$
\Phi(z) = 1 + \theta_{1} z + \dots + \theta_{q} z^{q} = 0
$$

- <span style="color: rgb(255, 0, 0);">特性方程式の全ての解の絶対値が $1$ より大きい ⇒ MA過程は反転可能</span>

### 2.2.3 ARMA過程の定常性・反転可能性 {-}

- AR過程は, 反転可能であるが, 定常とは限らない

- MA過程は, 定常であるが, 反転可能とは限らない

- ARMA過程

    - AR部分が定常 ⇒ ARMA過程も定常
    
    - MA部分が反転可能 ⇒ ARMA過程も反転可能

<p><br></p>

### 補足: 特性方程式と定常性 {-}

**ラグ作用素 (Lag Operator)**

関数 $f(t)$ を $f(t - 1)$ に写す作用素を $L$ とする.

- $L f(t) = f(t - 1)$
  
- $y_{t}$ を $t$ の関数と考えると $L y_{t} = y_{t - 1}$ ($t$ 時点の値を $t - 1$ 時点の値に写す)

ラグ作用素は次の演算が可能である.

- スカラー倍: $L c y_{t} = c L y_{t} = c y_{t - 1}$

- 積: $L L y_{t} = L y_{t - 1} = y_{t - 2}$

- 商: $\lvert \lambda \rvert < 1$ のとき
$$
(1 - \lambda L)^{-1} = \lim_{m \to \infty} (1 + \lambda L + \cdots + \lambda^{m} L^{m})
$$

**AR(1)**

次の AR(1) を考える.
$$
y_{t} - \phi_{1} y_{t - 1} = \varepsilon_{t}
$$

ラグ作用素を用いると
$$
y_{t} - \phi_{1} L y_{t} = (1 - \phi_{1} L) y_{t} = \varepsilon_{t}
$$
より, 次である.
$$
y_{t} = (1 - \phi_{1} L)^{-1} \varepsilon_{t} = \lim_{m \to \infty} \sum_{k = 0}^{m} (\phi_{1} L)^{k} \varepsilon_{t} = \lim_{m \to \infty} \sum_{k = 0}^{m} \phi_{1}^{k} \varepsilon_{t - k}
$$

- <span style="color: rgb(255, 0, 0);">$\lvert \phi_{1} \rvert < 1$ ⇒ 収束 ⇒ MA過程で表現可能 ⇒ 定常</span>

**AR($p$)**

次の AR($p$) を考える.
$$
y_{t} = \phi_{1} y_{t - 1} + \dots + \phi_{p} y_{t - p} + \varepsilon_{t}
$$

特性方程式 $\Phi(z) = 1 - \phi_{1} z - \dots - \phi_{p} z^{p} = 0$ の解を $\lambda_{1}, \dots, \lambda_{p}$ とすると, 次である.
$$
\Phi(z) = \left( 1 − \frac{z}{\lambda_{1}} \right) \cdots \left( 1 − \frac{z}{\lambda_{p}} \right)
$$
$y_{t} - \phi_{1} y_{t - 1} - \dots - \phi_{p} y_{t - p} = \varepsilon_{t}$ であるから, ラグ作用素を用いると
$$
y_{t} - \phi_{1} L y_{t} - \dots - \phi_{p} L^{p} y_{t} = (1 - \phi_{1} L - \dots - \phi_{p} L^{p}) y_{t} = \Phi(L) y_{t} = \varepsilon_{t}
$$
より, 次である.
$$
y_{t} = \Phi(L)^{-1} \varepsilon_{t} = \left( 1 − \frac{L}{\lambda_{1}} \right)^{-1} \dots \left( 1 − \frac{L}{\lambda_{p}} \right)^{-1} \varepsilon_{t} = \lim_{m_{1} \to \infty} \sum_{k_{1} = 0}^{m_{1}} \left( \frac{L}{\lambda_{1}} \right)^{k_{1}} \dots \lim_{m_{p} \to \infty} \sum_{k_{p} = 0}^{m_{p}} \left( \frac{L}{\lambda_{p}} \right)^{k_{p}} \varepsilon_{t}
$$

- $\left\lvert \dfrac{1}{\lambda_{j}} \right\rvert < 1$ $(j = 1, \dots, p)$ ⇔ $\lvert \lambda_{j} \rvert > 1$ $(j = 1, \dots, p)$ ⇒ 収束 ⇒ MA過程で表現可能 ⇒ 定常

- <span style="color: rgb(255, 0, 0);">特性方程式の全ての解の絶対値が $1$ より大きい ⇒ AR過程は定常</span>